//检测版本更新
54 00 头 
00 1A 数据大小
00 01 检测是否有更新  00 02 升级  00 03
00 00 00 00 00 00 00 00 00 00 00 00  版本号
02 00 00 02 CRC32 
00 00 包号 

终端发来的第一包数据  检测更新
54 00 头		2
00 29  数据大小		2
00 01  检查是否更新		2
31 2E 30 2E 30 2E 30 00 FD FD FD FD 41 00 00 00   版本号		16
12 34 56 78 		CRC32		4
00 00  包号		2
10 53 39 38 30 31 31 34 2D 30 35 30 32 30 37 30 31  SN号长度+SN号		17
5B	1



00 2F 45 00 00 09 01 01 75 E1 5D FA 01 30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01


10 机具号大小
31 30 30 35 53 39 2D 33 43 30 30 30 30 30 31 机具号
10 芯片ID大小
31 30 30 35 53 39 2D 33 43 30 30 30 30 30 31 芯片ID
03 ACK


终端包头都是 54 00  平台返回是 45 00      00  01 请求平台查询更新 
54 00 00 26 00 01 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 02 00 00 10 31 30 30 35 53 39 2D 33 43 30 30 30 30 30 31 03 


//有一个更新新 + 新的CRC32  +更新的包数     01 01 有更新包  01 00无升级包
45 00 00 0A  01 00  02 00 00 02  00 00  03


 
发送更新   00 02 请求更新,第一次包号为0,平台会下发擦除指令,
54 00 00 26 00 02 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 02 00 00  10 31 30 30 35 53 39 2D 33 43 30 30 30 30 30 31 03 


//平台收到更新请求,发送擦除指令,擦除指令发送成功以后,则开始请求据包

1A 擦除 08 02 00 00 起地址  03 E8擦除大小 08 00擦除个数
45 00 00 0A 1A 00 08 02 00 00 03 E8 08 00 03  



//开始升级请求第一包数据                                          00 01 包号
54 00 00 26 00 02 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 02 00 01  10 31 30 30 35 53 39 2D 33 43 30 30 30 30 30 31  03 



 







终端 发送  00 01 检查是否更新 
           01 01 有更新包    01 00 无更新  

终端发送   00 02 更新    
           1A 00 擦除指令


终端  发送  00 02  00 01 请求第一包数据

            02 00   发送第一包数据


平台回应
           02 01 证明发送完成


终端处理数据完成  发送
             02 02 升级完成  03 02 

 平台  回应  02 01 升级完成




如果断包 需要重连  
      终端发送 01 02 00 10 请求第16包数据

平台返回第16包数据


            






终端
54 00 头 
00 1A 数据大小
00 90 检测  当前SN号是否有效  00 91 设置当前SN号已被使用  00 92  生产厂测试   芯片ID在生产测试传,其他地方可不传

00 00 00 00 00 00 00 00 00 00 00 00  BOOT版本号

02 00 00 02 CRC32 
00 00 包号 


10 机具号大小
31 30 30 35 53 39 2D 33 43 30 30 30 30 30 31 机具号
10  芯片ID大小
31 30 30 35 53 39 2D 33 43 30 30 30 30 30 31 16位数芯片ID
  
03 ACK


平台返回 90 01 则当前机具号可用 90 00 当前机具号不可用
平台返回 91 01 则当前机具号已被设置使用






操作mysql数据库用到连接池




























